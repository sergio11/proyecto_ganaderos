
(function (w, $) {


    //Cameras.
    var cameras = [
		{
		    'title': 'Cámara 1',
		    'url': 'rtsp://212.128.154.128:554/live/ch0',
		    'coords': {
		        'lat': 40.795728,
		        'lng': -6.242950
		    },
		    'area': [
				{
				    'lat': 40.795728,
				    'lng': -6.242950
				},
				{
				    'lat': 40.795548,
				    'lng': -6.242792
				},
				{
				    'lat': 40.795781,
				    'lng': -6.242253
				},
				{
				    'lat': 40.795970,
				    'lng': -6.242492
				},
				{
				    'lat': 40.795728,
				    'lng': -6.242950
				}
			],
		    'zones': [
		        [
		            {
		                'lat': 40.795733,
		                'lng': -6.242944
		            },
		            {
		                'lat': 40.795968,
		                'lng': -6.242486
		            },
		            {
		                'lat': 40.795885,
		                'lng': -6.242382
		            },
		            {
		                'lat': 40.795654,
		                'lng': -6.242880
		            },
		            {
		                'lat': 40.795733,
		                'lng': -6.242944
		            }
               ]
		    ]
		},
		{
		    'title': 'Cámara 2',
		    'url': 'rtsp://212.128.154.128:554/live/ch0',
		    'coords': {
		        'lat': 40.796053,
		        'lng': -6.242559
		    },
		    'area': [
				{
				    'lat': 40.796053,
				    'lng': -6.242559
				},
				{
				    'lat': 40.796566,
				    'lng': -6.242636
				},
				{
				    'lat': 40.797076,
				    'lng': -6.241637
				},
				{
				    'lat': 40.796768,
				    'lng': -6.241316
				},
				{
				    'lat': 40.796442,
				    'lng': -6.241644
				},
				{
				    'lat': 40.796158,
				    'lng': -6.241365
				},
				{
				    'lat': 40.795878,
				    'lng': -6.241990
				},
				{
				    'lat': 40.796053,
				    'lng': -6.242559
				}
			],
		    'zones': [
                [
                    {
                        'lat': 40.796053,
                        'lng': -6.242559
                    },
                    {
                        'lat': 40.796569,
                        'lng': -6.242629
                    },
                    {
                        'lat': 40.796728,
                        'lng': -6.242317
                    },
                    {
                        'lat': 40.796053,
                        'lng': -6.242559
                    }

                ],
                [
                    {
                        'lat': 40.796053,
                        'lng': -6.242559
                    },
                    {
                        'lat': 40.796728,
                        'lng': -6.242317
                    },
                    {
                        'lat': 40.796958,
                        'lng': -6.241863
                    },
                    {
                        'lat': 40.796053,
                        'lng': -6.242559
                    }
                ],
                [
                    {
                        'lat': 40.796053,
                        'lng': -6.242559
                    },
                    {
                        'lat': 40.796958,
                        'lng': -6.241863
                    },
                    {
                        'lat': 40.797072,
                        'lng': -6.241640
                    },
                    {
                        'lat': 40.796863,
                        'lng': -6.241426
                    },
                    {
                        'lat': 40.796053,
                        'lng': -6.242559
                    }

                ],
                [
                    {
                        'lat': 40.796053,
                        'lng': -6.242559
                    },
                    {
                        'lat': 40.796863,
                        'lng': -6.241426
                    },
                    {
                        'lat': 40.796770,
                        'lng': -6.241324
                    },
                    {
                        'lat': 40.796437,
                        'lng': -6.241638
                    },
                    {
                        'lat': 40.796053,
                        'lng': -6.242559
                    }
                ],
                [
                    {
                        'lat': 40.796053,
                        'lng': -6.242559
                    },
                    {
                        'lat': 40.796437,
                        'lng': -6.241638
                    },
                    {
                        'lat': 40.796279,
                        'lng': -6.241449
                    },
                    {
                        'lat': 40.796053,
                        'lng': -6.242559
                    }
                ],
                [
                    {
                        'lat': 40.796053,
                        'lng': -6.242559
                    },
                    {
                        'lat': 40.796279,
                        'lng': -6.241449
                    },
                    {
                        'lat': 40.796162,
                        'lng': -6.241379
                    },
                    {
                        'lat': 40.796001,
                        'lng': -6.241717
                    },
                    {
                        'lat': 40.796053,
                        'lng': -6.242559
                    }
                ],
                [
                    {
                        'lat': 40.796053,
                        'lng': -6.242559
                    },
                    {
                        'lat': 40.796001,
                        'lng': -6.241717
                    },
                    {
                        'lat': 40.795878,
                        'lng': -6.241990
                    },
                    {
                        'lat': 40.796053,
                        'lng': -6.242559
                    }
                ]
            ]
		},
		{
		    'title': 'Cámara 3',
		    'url': 'rtsp://212.128.154.128:554/live/ch0',
		    'coords': {
		        'lat': 40.796114,
		        'lng': -6.242665
		    },
		    'area': [
				{
				    'lat': 40.796114,
				    'lng': -6.242665
				},
				{
				    'lat': 40.796575,
				    'lng': -6.242641
				},
				{
				    'lat': 40.796837,
				    'lng': -6.242902
				},
				{
				    'lat': 40.796393,
				    'lng': -6.243674
				},
				{
				    'lat': 40.795912,
				    'lng': -6.243233
				},
				{
				    'lat': 40.796114,
				    'lng': -6.242665
				}
			],
		    'zones': [

            ]
		}
	];

    var cows = [
		{
		    'coords': {
		        'lat': 40.796581,
		        'lng': -6.242048
		    },
		    title: "Marker 1",
		    content: "Contenido del Marker 1"
		},
		{
		    'coords': {
		        'lat': 40.796406,
		        'lng': -6.241906
		    },
		    title: "Marker 2",
		    content: "Contenido del Marker 2"
		},
		{
		    'coords': {
		        'lat': 40.796574,
		        'lng': -6.242434
		    },
		    title: "Marker 3",
		    content: "Contenido del Marker 3"
		},
		{
		    'coords': {
		        'lat': 40.796030,
		        'lng': -6.242104
		    },
		    title: "Marker 4",
		    content: "Contenido del Marker 4"
		},
		{
		    'coords': {
		        'lat': 40.795747,
		        'lng': -6.242578
		    },
		    title: "Marker 5",
		    content: "Contenido del Marker 5"
		},
		{
		    'coords': {
		        'lat': 40.796352,
		        'lng': -6.243132
		    },
		    title: "Marker 6",
		    content: "Contenido del Marker 6"
		}
	];

    var angle = 15;
    //Google MAPS API loaded
    w.initMap = function () {

        //Instanciamos cámaras.
        cameras = cameras.map(function (data) {
            return new Camera(data);
        });


        //Instanciamos el mapa.
        var map = new Map(cameras, cows);
        map.load();

        map.addEventListener('change-zone', function (zone) {
            console.log("Change Zone To .... " + zone);
        });

        var controlPanel = new ControlPanel(cameras);
        //Implementamos manejadores.
        controlPanel.addEventListener('camera-zoom', function (zoom) {
            console.log("zoom");
            console.log(zoom);
            map.setZoom(zoom);
        });

        controlPanel.addEventListener('change-camera', function (i) {
            console.log("índice de la cámara actual : " + i);
            map.setCamera(i);
        });

        controlPanel.addEventListener('rotate-camera', function (direction) {
            map.rotatePolygon(direction);
        });

        //Inicio panel de control.
        controlPanel.init();

    }


})(window, jQuery);